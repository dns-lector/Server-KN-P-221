
'''
Модуль НТТР
Альтернативний до CGI підхід у створенні серверних застосунків
полягає у створенні власного (програмного)
сервера, що є частиною загального проєкту.
+ використовуємо єдину мову програмування (непотрібна конфігурація
   стороннього сервера окремою мовою)
+ уніфікуються ліцензійні умови
- дотримання стандартів і протоколів перекладається на проєкт
- частіше за все, програмні сервери більш повільні і не сертифіковані
- необхідність перезапуску сервера після внесення змін до скриптів

У Python такі засоби надає пакет http.server:
HTTPServer - клас управління сервером (слухання порту, прийом запитів), 
BaseHTTPRequestHandler - продовження оброблення, формування відповіді

У результаті досліджень з'ясовуємо
- на кожен запит утворюється новий об'єкт класу RequestHandler
- print виводить на консоль запуску, а не до відповіді сервера
- path відповідає за повний шлях запиту + параметри (query string)
- command відповідає за методи запиту
- маршрутизація не здійснюється

MVC                                            API
GET  /user/auth    | один                    GET  /user/auth    | різні 
POST /user/auth    | обробник                POST /user/auth    | обробники     
GET  /user/profile - інший обробник          GET  /user/profile - той самий, що й для GET  /user/auth       
'''

'''
Д.З. Додати на сайт (стартову сторінку) декілька посилань на цю ж адресу для 
випробування алгоритму розділення маршрутів:
- посилання без параметрів (/)
- посилання з сервісом (/user/, /user)
- посилання з розділами (/user/auth, /user/auth/secret),
- посилання з URL-кодованими значеннями (/user/%D0%A3%D0%BD%D1%96%D1%84%D1%96%D0%BA%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9&%D0%BB%D0%BE%D0%BA%D0%B0%D1%82%D0%BE%D1%80=%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D1%96%D0%B2&2+2=4)
'''

'''
REST - обмеження на структуру даних, які можна сприймати як доповнення даних метаданими
 - Layered System: користувач не повинен розрізняти випадки коли він прямо звертається
   до серверу або через транзитні вузли (проксі)
   ! вимога має бути проаналізована
[Client]             [Proxy: Apache]               [Server: Tomcat]
GET /item ------------->          ------------------> | Get
                                                      | Data
        Server: Apache           Server: Tomcat       | Logging: 1234100000 : Data
        Time: 1234100003         Time: 1234100000     |             
       <-------------------     <----------------------

! Традиційні елементи для метаданих - заголовки - не підходять для REST формалізму
  Рішення - включати метадані до тіла пакету, "змішуючи" їх з основними даними

[Client]             [Proxy: Apache]               [Server: Tomcat]
GET /item ------------->          ------------------> | ?? No Item
                                                      | 
             507                           404        |              
       <-------------------     <----------------------

! НТТР-статус коди не годяться для правильної передачі даних про помилки
  Рішення - розрізняти статуси передачі даних (каналу) та статуси оброблення даних,
   які також включати до тіла відповіді       

[Client]             [Proxy: Apache]               [Server: Tomcat]
GET /item ------------->          ------------------> | ?? No Item
                                                      | 200 + {status: 404}
                200                        200        |              
       <-------------------     <----------------------
            {status: 404}            {status: 404}

З урахуванням висловленого формуємо зразок відповіді:
{
    status: {             // Статус - виноситься з НТТР, перекладається до відповіді
        isOk: true,       // Гарна традиція: вживати різні типи даних
        code: 200,        // від логічного до рядкового з детальним поясненням
        phrase: "OK"      //   
    },
    meta: {
        uri: "https://my-site.loc/item?year=2026&month=2&day=10&shadeColor=gray&size=150&texturize=true",
        service: {
            "name": "e-Shop 'My Site'",
            "url": "https://my-site.loc/",
            "e-mail": "info@my-site.loc",
            "section": "Items: products available"
        },
        cache: 100500,
        variables: {                             !! розпізнані бекендом величини
            used: {                              !! не копії з запиту, а саме значення,
                "year": "2026",                  !! на які орієнтується сервер
                "month": "2",                        
                "day": "10",
                "shadeColor": "gray",
                "size": "150",
                "texturize": "true"
            },
            ignored: [
                { 
                    name: "lang",
                    sentValue: "uk",
                    usedValue: "en",
                    reason: "Unsupproted language code"
                }
            ]
        },
        manipulations: {
            read: "GET /item",
            delete: "DELETE /item",
            ...
        },
        links: {
            "sub-item": "/item/{id}",
            "search": "/item/search?q={fragment}",
            ...
        },
        dataType: "object",
        dataModel: {           // або посилання https://my-site.loc/models/item
            "id": {
                fieldType: "string",
                fieldSubType: "UUID",
                fieldDescription: "Identifier of item"
            },
            "title": {
                fieldType: "string",
                filedMaxSize: 256,
                fieldDescription: "Name of item by producer"
            },
            ...
            "price": {
                fieldType: "number",
                fieldSubType: "float",
                fieldDescription: "Price of item in UAH"
            }
        }
    },
    data: {
        id: "184fa9a3-f967-4a98-9d8f-57152e7cbe64",
        title: "The best Item",
        ...
        price: 149.50
    }
}

Д.З. Скласти метадані для даних типу "масив",
передбачити пагінацію
Дотримуватись принципів REST
'''